# Firebase Authentication æœƒå“¡ç³»çµ±å¯¦æ–½æŒ‡å—

## ğŸ‰ ç³»çµ±æ¦‚è¦½

åŸºæ–¼ Firebase Authentication çš„ HK Insurance AML æŸ¥è©¢ç³»çµ±æœƒå“¡åŠŸèƒ½å·²æˆåŠŸå¯¦æ–½ï¼é€™æ˜¯ä¸€å€‹å®Œæ•´çš„é‡æ§‹ï¼Œå¾è‡ªè¨‚èªè­‰ç³»çµ±é·ç§»åˆ°ç¾ä»£åŒ–çš„ Firebase Auth è§£æ±ºæ–¹æ¡ˆã€‚

## ğŸ“‹ å¯¦æ–½çš„åŠŸèƒ½

### âœ… èº«ä»½é©—è­‰ç³»çµ±
- **Firebase Authentication**: ä½¿ç”¨ Firebase Auth SDK é€²è¡Œç”¨æˆ¶ç®¡ç†
- **é›»å­éƒµä»¶/å¯†ç¢¼ç™»å…¥**: å®‰å…¨çš„ç”¨æˆ¶è¨»å†Šå’Œç™»å…¥æµç¨‹
- **å¯†ç¢¼å¼·åº¦è¦æ±‚**: åŒ…å«å­—æ¯ã€æ•¸å­—ï¼Œæœ€å°‘6å€‹å­—ç¬¦
- **å³æ™‚é©—è­‰**: å‰ç«¯è¡¨å–®é©—è­‰å’Œå¾Œç«¯ Token é©—è­‰

### âœ… ç”¨æˆ¶ä»‹é¢
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**: æ”¯æ´æ¡Œé¢å’Œæ‰‹æ©Ÿè¨­å‚™
- **ç¾ä»£åŒ– UI**: æ¼‚äº®çš„ç™»å…¥/è¨»å†Šè¡¨å–®
- **ç”¨æˆ¶é«”é©—**: è¼‰å…¥ç‹€æ…‹ã€éŒ¯èª¤è¨Šæ¯ã€æˆåŠŸæç¤º
- **ç„¡ç¸«é›†æˆ**: èˆ‡ç¾æœ‰ AML æŸ¥è©¢ç³»çµ±å®Œç¾æ•´åˆ

### âœ… å®‰å…¨æ€§
- **Bearer Token èªè­‰**: å¾Œç«¯ API ä½¿ç”¨ JWT Token é©—è­‰
- **è§’è‰²ç®¡ç†**: æ”¯æ´ç”¨æˆ¶å’Œç®¡ç†å“¡è§’è‰²
- **CORS å®‰å…¨**: é©ç•¶çš„è·¨åŸŸè³‡æºåˆ†äº«è¨­ç½®
- **è³‡æ–™ä¿è­·**: ç¬¦åˆç¾ä»£å®‰å…¨æ¨™æº–

## ğŸš€ ç³»çµ±æ¶æ§‹

```
ğŸ“¦ Firebase Auth ç³»çµ±
â”œâ”€â”€ ğŸ”¥ Firebase Emulator (é–‹ç™¼)
â”‚   â”œâ”€â”€ Auth: 127.0.0.1:9099
â”‚   â”œâ”€â”€ Firestore: 127.0.0.1:8081
â”‚   â””â”€â”€ UI: 127.0.0.1:4000
â”œâ”€â”€ ğŸ Flask å¾Œç«¯
â”‚   â”œâ”€â”€ main_simple.py (ç°¡åŒ–ç‰ˆ)
â”‚   â”œâ”€â”€ main_firebase.py (å®Œæ•´ç‰ˆ)
â”‚   â””â”€â”€ firebase_config.py (é…ç½®)
â”œâ”€â”€ ğŸ¨ å‰ç«¯ä»‹é¢
â”‚   â”œâ”€â”€ login_firebase.html
â”‚   â”œâ”€â”€ register_firebase.html
â”‚   â””â”€â”€ query_firebase.html
â””â”€â”€ ğŸ“Š AML æŸ¥è©¢ç³»çµ±
    â”œâ”€â”€ éœ€è¦ç™»å…¥æ‰èƒ½æŸ¥è©¢
    â”œâ”€â”€ å…¬é–‹çµ±è¨ˆè³‡è¨Š
    â””â”€â”€ ç®¡ç†å“¡åŠŸèƒ½é ç•™
```

## ğŸ’» ä½¿ç”¨èªªæ˜

### é–‹ç™¼ç’°å¢ƒå•Ÿå‹•

1. **å•Ÿå‹• Firebase Emulator**:
```bash
cd /home/weschen/HK_insurance
firebase emulators:start --project=demo-project
```

2. **å•Ÿå‹• Flask æ‡‰ç”¨**:
```bash
cd /home/weschen/HK_insurance
source .venv/bin/activate
cd hk-ia-function
FIRESTORE_EMULATOR_HOST=127.0.0.1:8081 PORT=8001 python main_simple.py
```

3. **è¨ªå•æ‡‰ç”¨**:
- ä¸»é : http://127.0.0.1:8001
- ç™»å…¥: http://127.0.0.1:8001/login  
- è¨»å†Š: http://127.0.0.1:8001/register
- Firebase UI: http://127.0.0.1:4000

### ç”¨æˆ¶æµç¨‹

1. **æ–°ç”¨æˆ¶è¨»å†Š**:
   - è¨ªå•è¨»å†Šé é¢
   - è¼¸å…¥é›»å­éƒµä»¶å’Œå¯†ç¢¼
   - Firebase è‡ªå‹•å‰µå»ºå¸³æˆ¶
   - è‡ªå‹•è·³è½‰åˆ°ç™»å…¥é é¢

2. **ç”¨æˆ¶ç™»å…¥**:
   - è¼¸å…¥è¨»å†Šçš„é›»å­éƒµä»¶å’Œå¯†ç¢¼
   - Firebase é©—è­‰èº«ä»½
   - ç²å– ID Token
   - è‡ªå‹•è·³è½‰åˆ°ä¸»é 

3. **AML æŸ¥è©¢**:
   - ç™»å…¥å¾Œå¯ä»¥é€²è¡Œå§“åæŸ¥è©¢
   - æœªç™»å…¥ç”¨æˆ¶æœƒçœ‹åˆ°ç™»å…¥æç¤º
   - æŸ¥è©¢çµæœé¡¯ç¤ºå®Œæ•´è³‡æ–™

## ğŸ”§ æª”æ¡ˆèªªæ˜

### å¾Œç«¯æª”æ¡ˆ

- **`main_simple.py`**: ç°¡åŒ–ç‰ˆ Flask æ‡‰ç”¨ï¼Œé©åˆé–‹ç™¼å’Œæ¸¬è©¦
- **`main_firebase.py`**: å®Œæ•´ç‰ˆ Firebase Auth é›†æˆï¼ˆéœ€è¦å®Œæ•´ Firebase Admin SDKï¼‰
- **`firebase_config.py`**: Firebase é…ç½®å’Œèº«ä»½é©—è­‰è¼”åŠ©å‡½æ•¸
- **`requirements.txt`**: å·²æ›´æ–°åŒ…å« `firebase-admin==6.2.0`

### å‰ç«¯æ¨¡æ¿

- **`login_firebase.html`**: Firebase Auth ç™»å…¥é é¢
- **`register_firebase.html`**: Firebase Auth è¨»å†Šé é¢  
- **`query_firebase.html`**: æ•´åˆ Firebase Auth çš„æŸ¥è©¢é é¢

### é…ç½®æª”æ¡ˆ

- **`firebase.json`**: Firebase æ¨¡æ“¬å™¨é…ç½®
- **`firestore.rules`**: Firestore å®‰å…¨è¦å‰‡ï¼ˆæ”¯æ´ Firebase Authï¼‰

## ğŸŒŸ ä¸»è¦å„ªå‹¢

### ğŸ”’ å®‰å…¨æ€§æå‡
- æ¥­ç•Œæ¨™æº–çš„èº«ä»½é©—è­‰ç³»çµ±
- è‡ªå‹•è™•ç†å¯†ç¢¼åŠ å¯†å’Œ Token ç®¡ç†
- é˜²æ­¢å¸¸è¦‹çš„å®‰å…¨æ¼æ´

### ğŸ“± ç”¨æˆ¶é«”é©—
- ç¾ä»£åŒ–çš„ç”¨æˆ¶ç•Œé¢
- éŸ¿æ‡‰å¼è¨­è¨ˆæ”¯æ´å¤šè¨­å‚™
- å³æ™‚é©—è­‰å’ŒéŒ¯èª¤æç¤º

### ğŸ›  é–‹ç™¼æ•ˆç‡
- Firebase æä¾›å®Œæ•´çš„èº«ä»½é©—è­‰æœå‹™
- æ¸›å°‘è‡ªè¨‚èªè­‰ç³»çµ±çš„ç¶­è­·æˆæœ¬
- æ˜“æ–¼æ“´å±•å’Œæ•´åˆå…¶ä»– Firebase æœå‹™

### ğŸš€ å¯æ“´å±•æ€§
- æ”¯æ´å¤šç¨®ç™»å…¥æ–¹å¼ï¼ˆé›»å­éƒµä»¶ã€Googleã€Facebookç­‰ï¼‰
- å…§å»ºç”¨æˆ¶ç®¡ç†å’Œåˆ†æåŠŸèƒ½
- é›²ç«¯è¨—ç®¡ï¼Œç„¡éœ€ä¼ºæœå™¨ç¶­è­·

## ğŸ“ˆ ä¸‹ä¸€æ­¥è¦åŠƒ

### ğŸ¯ çŸ­æœŸç›®æ¨™
- [ ] ç®¡ç†å“¡é¢æ¿å®Œæ•´å¯¦æ–½
- [ ] ç”¨æˆ¶å€‹äººè³‡æ–™ç®¡ç†
- [ ] æŸ¥è©¢æ­·å²è¨˜éŒ„
- [ ] é€²éšè§’è‰²æ¬Šé™ç®¡ç†

### ğŸš€ é•·æœŸè¦åŠƒ
- [ ] ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²
- [ ] å¤šå› ç´ èº«ä»½é©—è­‰
- [ ] ç¤¾äº¤åª’é«”ç™»å…¥é›†æˆ
- [ ] é€²éšåˆ†æå’Œå ±å‘Š

## ğŸ‰ çµè«–

Firebase Authentication æœƒå“¡ç³»çµ±çš„å¯¦æ–½ç‚º HK Insurance AML æŸ¥è©¢ç³»çµ±å¸¶ä¾†äº†ç¾ä»£åŒ–çš„èº«ä»½é©—è­‰åŠŸèƒ½ã€‚ç³»çµ±ç¾åœ¨å…·å‚™ï¼š

âœ… **å®‰å…¨**: ä½¿ç”¨æ¥­ç•Œæ¨™æº–çš„ Firebase Auth  
âœ… **æ˜“ç”¨**: ç›´è§€çš„ç”¨æˆ¶ä»‹é¢å’Œæµç¨‹  
âœ… **å¯é **: ç¶“éæ¸¬è©¦çš„èªè­‰å’ŒæŸ¥è©¢åŠŸèƒ½  
âœ… **å¯æ“´å±•**: ç‚ºæœªä¾†åŠŸèƒ½æ“´å±•åšå¥½æº–å‚™  

ç³»çµ±å·²æº–å‚™å¥½é€²è¡Œé€²ä¸€æ­¥çš„é–‹ç™¼å’Œéƒ¨ç½²ï¼ğŸš€
